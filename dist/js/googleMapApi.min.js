function makeCallback(a){return function(b,c){c===google.maps.places.PlacesServiceStatus.OK?a.marker=createMarker(b):c===google.maps.places.PlacesServiceStatus.ERROR?$("#map").append("<p>There was a problem contacting the Google servers</p>"):$("#map").append("<p>Sorry, could not get the map</p>")}}function createMarker(a){var b={url:a.icon,scaledSize:new google.maps.Size(25,25),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(12,15)},c=new google.maps.Marker({map:map,position:a.geometry.location,icon:b});return markers.push(c),addPins(a,c),c}function filter(a){clearMarkers();var b={location:loc,radius:1500,type:a};service.nearbySearch(b,callbackFilter)}function specialSearch(a){clearMarkers();var b={location:loc,radius:1e3,query:a};service.textSearch(b,callbackFilter)}function callbackFilter(a,b){if(b==google.maps.places.PlacesServiceStatus.OK)for(var c=0;c<a.length;c++){var d=a[c];d.marker=createMarker(a[c]),model.placeList.push(new MapData(d))}else if(b==google.maps.places.PlacesServiceStatus.ZERO_RESULTS){var e={name:"Sorry, no result found, try another one",icon:"http://www.pic4ever.com/images/kaffeetrinker_2.gif"};model.placeList.push(new MapData(e))}else{var f={name:"Sorry, something went wrong, try again later",icon:"http://www.pic4ever.com/images/kaffeetrinker_2.gif"};model.placeList.push(new MapData(f))}}function setMapOnAll(a){for(var b=0;b<markers.length;b++)markers[b].setMap(a)}function clearMarkers(){setMapOnAll(null),markers=[]}var map,infowindow,service,markers=[],loc={lat:52.51,lng:13.38},initMap=function(){map=new google.maps.Map(document.getElementById("map"),{center:loc,zoom:13}),infowindow=new google.maps.InfoWindow,service=new google.maps.places.PlacesService(map);for(var a=0;a<model.placeList().length;a++){var b=model.placeList()[a];service.getDetails(b,makeCallback(b))}},addPins=function(a,b){google.maps.event.addListener(b,"click",function(){infowindow.setContent("<div><strong>"+a.name+'</strong><br><img id="icon" src='+a.icon+"></div><div class=wiki-container><ul class=wiki-links></ul></div>"),wikiRequest(a.name),this.setIcon("https://www.google.com/mapfiles/marker_green.png"),infowindow.open(self.map,this),toggleBounce(b)})},toggleBounce=function(a){google.maps.event.addListener(a,"click",toggleBounceList(a))};model.currentPlace.subscribe(function(a){infowindow.setContent("<div><strong>"+a.name+'</strong><br><img id="icon" src='+a.icon+"></div><div class=wiki-container><ul class=wiki-links></ul></div>"),wikiRequest(a.name),infowindow.open(self.map,a.marker),a.marker.setIcon("https://www.google.com/mapfiles/marker_green.png"),toggleBounceList(a.marker)});var toggleBounceList=function(a){a.getAnimation()?a.setAnimation(null):a.setAnimation(google.maps.Animation.BOUNCE)};